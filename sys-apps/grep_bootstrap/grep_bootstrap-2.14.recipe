SUMMARY="GNU regular expression matcher"
DESCRIPTION="The grep command searches one or more input files for lines containing a match to a specified pattern. By default, grep prints the matching lines."
HOMEPAGE="http://www.gnu.org/software/grep/"
LICENSE="GNU GPL v3"
COPYRIGHT="1992-2012 Free Software Foundation, Inc."
SRC_URI="http://ports-space.haiku-files.org/source/grep-2.14.tar.bz2"
CHECKSUM_MD5="db55b9fc67d8c0895f3c73e94e2aebe3"
REVISION="1"
ARCHITECTURES="x86_gcc2 x86"

PATCHES="grep_bootstrap-2.14.patchset"

PROVIDES="
	grep_bootstrap = $portVersion compat >= 2
	grep = $portVersion compat >= 2
	cmd:egrep = $portVersion compat >= 2
	cmd:fgrep = $portVersion compat >= 2
	cmd:grep = $portVersion compat >= 2
	"
REQUIRES="
	haiku >= $haikuVersion
	"
BUILD_REQUIRES="
	"
BUILD_PREREQUIRES="
	haiku_devel >= $haikuVersion
	binutils_cross_$targetArchitecture
	gcc_cross_$targetArchitecture
	cmd:aclocal
	cmd:autoconf
	cmd:automake
	cmd:libtoolize
	cmd:make
	"

SOURCE_DIR="grep-$portVersion"

BUILD()
{
	rm -f m4/iconv* m4/gettext*
	libtoolize --force --copy --install
	aclocal -I m4
	automake
	autoreconf
	runConfigure ./configure \
		--build=$buildMachineTriple --host=$targetMachineTriple \
		--disable-perl-regexp --disable-nls
	make $jobArgs
}

INSTALL()
{
	make DESTDIR=$installDestDir install

	$targetMachineTriple-strip $installDestDir$binDir/*

	rm $installDestDir$libDir/charset.alias
	rmdir $installDestDir$libDir
	rm -r $installDestDir$infoDir
}
